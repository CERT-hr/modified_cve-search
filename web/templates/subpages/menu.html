<!-- Nav -->
<div class="navbar navbar-default">
  <div class="navbar-header">
    <a class="navbar-brand" href="/">cve-search</a>
  </div>
  <div class="container">
    <ul class="nav navbar-nav" style="display: table">
      <li><a href="/">Najnoviji unosi</a></li>
      <li><a href="/browse">Pretraži prema proizvođaču</a></li>
      <li><a href="/cwe">Pretraži prema CWE oznaci</a></li>
      <li>
        <div class="col-sm-3">
          <form id="tfnewsearch" method="get" class="input-group navbar-form"onsubmit="redirect(); return false;"> 
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
            <input type="text" class="form-control input-sm" id="search" placeholder="Pretraži CVE" value="{{freetextsearch}}"/>
            <span class="input-group-btn">
              <input type="submit" class="btn btn-default input-sm" value="Pretraži" />
            </span>
          </form>
        </div>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right">
      <li><a class="navbar-nav pull-right" href="/admin">Admin</a></li>
      {% if current_user.is_authenticated() %}
        <li><a class="navbar-nav pull-right" href="/logout"><span class="glyphicon glyphicon-log-out"></span></a></li>
      {% endif %}
      </ul>
  </div>
</div>
<script>
//Search function
function redirect() {
  var search = document.getElementById("search").value
  if(/^CVE-[0-9]{4}-[0-9]{4,6}$/.test(search.toUpperCase())){
    var url = "/cve/" + search; window.location = url;
  }else{
    var form = document.createElement("form");
    form.method="POST";
    form.action="/search";
    var field = document.createElement("INPUT");
    field.type = "hidden";
    field.name = "search"
    field.value = search
    form.appendChild(field);
    var csrfField = document.createElement("INPUT");
    csrfField.type = "hidden";
    csrfField.name = "csrf_token"
    csrfField.value = "{{ csrf_token() }}";
    form.appendChild(csrfField);
    document.body.appendChild(form);
    form.submit();
  }

}
</script>
<!-- End Nav -->
